<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K·∫øt Qu·∫£ T√¨m Ki·∫øm - Eco Food</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <style>
        .dropdown-item:hover .dropdown-menu {
            display: block;
        }

    </style>
</head>
<body class="bg-light">
<div class="container-fluid p-0">
    <div class="row g-0">
        <!-- Sidebar tr√°i -->
        <th:block th:replace="~{client/layout/sidebar-left :: sidebarLeft}"></th:block>
        <!-- N·ªôi dung ch√≠nh -->
        <div class="col-md-7 offset-md-2 bg-white p-3 mt-3">
            <div class="bg-white p-3">
                <!-- Header -->
                <div class="text-center mb-3">
                    <h1 class="fw-bold fs-4 mb-2">G√≥i N√¢ng C·∫•p c·ªßa b·∫°n</h1>
                    <h2 class="fs-6 text-muted mb-2">
                        G√≥i N√¢ng C·∫•p gi√∫p l√™n th·ª±c ƒë∆°n<br>
                        h√†ng ng√†y d·ªÖ d√†ng h∆°n
                    </h2>
                    <div class="d-flex justify-content-center mb-2">
                        <span class="fs-4">üèÖ</span>
                    </div>
                </div>

                <!-- Comparison Table -->
                <div class="mb-4">
                    <div class="w-75 mx-auto">
                        <table class="table table-bordered table-sm">
                            <thead>
                            <tr>
                                <th scope="col" class="bg-light"></th>
                                <th scope="col" class="text-center bg-light">Mi·ªÖn Ph√≠</th>
                                <th scope="col" class="text-center bg-light">G√≥i N√¢ng C·∫•p</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td class="small">Kh√¥ng qu·∫£ng c√°o</td>
                                <td class="text-center text-success"><i class="bi bi-check-lg"></i></td>
                                <td class="text-center text-success"><i class="bi bi-check-lg"></i></td>
                            </tr>
                            <tr>
                                <td class="small">Top m√≥n ph·ªï bi·∫øn hi·ªán ƒë·∫ßu ti√™n</td>
                                <td class="text-center"></td>
                                <td class="text-center text-success"><i class="bi bi-check-lg"></i></td>
                            </tr>
                            <tr>
                                <td class="small">Top m√≥n ngon ƒë∆∞·ª£c y√™u th√≠ch nh·∫•t</td>
                                <td class="text-center"></td>
                                <td class="text-center text-success"><i class="bi bi-check-lg"></i></td>
                            </tr>
                            <tr>
                                <td class="small">B·ªô l·ªçc t√¨m ki·∫øm n√¢ng cao</td>
                                <td class="text-center"></td>
                                <td class="text-center text-success"><i class="bi bi-check-lg"></i></td>
                            </tr>
                            <tr>
                                <td class="small">B·ªô s∆∞u t·∫≠p M√≥n-T·ªß c·ªßa b·∫°n</td>
                                <td class="text-center"></td>
                                <td class="text-center text-success"><i class="bi bi-check-lg"></i></td>
                            </tr>
                            <tr>
                                <td class="small">B·ªô s∆∞u t·∫≠p m√≥n ngon t√πy ch·ªânh</td>
                                <td class="text-center"></td>
                                <td class="text-center text-success"><i class="bi bi-check-lg"></i></td>
                            </tr>
                            <tr>
                                <td class="small">G·ª£i √Ω th·ª±c ƒë∆°n h√†ng ng√†y</td>
                                <td class="text-center"></td>
                                <td class="text-center text-success"><i class="bi bi-check-lg"></i></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Premium Package -->
                <div class="mb-4" th:switch="${user.getPremium()}">
                    <!-- N·∫øu user.premium == true -->
                    <div th:case="true" class="w-75 mx-auto">
                        <div class="border rounded p-3 text-center">
                            <div class="d-flex justify-content-center mb-2">
                                <span class="fs-4 me-2">üèÖ</span>
                                <h3 class="mb-0 fs-5">G√≥i N√¢ng C·∫•p c·ªßa b·∫°n</h3>
                            </div>
                            <p class="text-success mb-3">B·∫°n ƒë√£ k√≠ch ho·∫°t th√†nh c√¥ng g√≥i N√¢ng C·∫•p!</p>
                            <p class="text-muted mb-3" th:if="${daysLeft > 0}">
                                C√≤n l·∫°i <span th:text="${daysLeft}"></span> ng√†y.
                            </p>
                            <p class="text-muted mb-3" th:if="${daysLeft == 0}">
                                G√≥i N√¢ng C·∫•p ƒë√£ h·∫øt h·∫°n ho·∫∑c ch∆∞a k√≠ch ho·∫°t.
                            </p>
                        </div>
                    </div>

                    <!-- N·∫øu user.premium == false -->
                    <div th:case="false" class="w-75 mx-auto">
                        <div class="border rounded p-3">
                            <div class="d-flex align-items-center mb-2">
                                <span class="fs-4 me-2">üèÖ</span>
                                <h3 class="mb-0 fs-5">G√≥i N√¢ng C·∫•p c·ªßa b·∫°n</h3>
                            </div>

                            <table class="table mb-3 table-sm">
                                <tr>
                                    <td class="border-0 small">Gi√° ph√≠</td>
                                    <td class="text-end border-0 fw-bold small">25.000 ƒë/Th√°ng</td>
                                </tr>
                            </table>

                            <hr>

                            <div class="text-center">
                                <form action="/create-payment-link" method="post">
                                    <button type="submit" class="btn btn-primary">Thanh to√°n ngay</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
        </div>

        <!-- Sidebar ph·∫£i -->
        <th:block th:replace="~{client/layout/sidebar-right :: sidebarRight}"></th:block>
            <!-- Load modal "B·∫øp c·ªßa b·∫°n" -->
            <div th:replace="~{client/layout/sidebar-right :: userProfileModal}"></div>

            <div th:replace="~{client/layout/sidebar-right :: editProfileModal}"></div>

            <div th:replace="~{client/layout/sidebar-right :: updatePasswordModal}"></div>
            <div th:replace="~{client/layout/sidebar-right :: deleteAccountModal}"></div>
            <div th:replace="~{client/layout/sidebar-right :: feedbackModal}"></div>
            <!-- Th√™m fragment Toast -->
            <div th:replace="~{client/layout/toast :: toast(failed=${failed}, success=${success})}"></div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>

        // xem truoc avatar
        function previewImage(event) {
            const reader = new FileReader();
            reader.onload = function() {
                const output = document.querySelector('#editProfileModal img');
                output.src = reader.result;
            }
            reader.readAsDataURL(event.target.files[0]);
        }

        // Gi·∫£ s·ª≠ modal c·ªßa b·∫°n c√≥ id "profileModal"
        const profileModal = new bootstrap.Modal(document.getElementById('profileModal'), {
            keyboard: false
        });

        // Function c·∫≠p nh·∫≠t profile v√† m·ªü l·∫°i modal sau khi update th√†nh c√¥ng
        function updateProfile(event) {
            event.preventDefault();  // Ng·ª´ng h√†nh ƒë·ªông m·∫∑c ƒë·ªãnh c·ªßa form

            // G·ª≠i d·ªØ li·ªáu c·∫≠p nh·∫≠t l√™n API
            const form = document.getElementById('updateProfileForm');
            const formData = new FormData(form);

            fetch('/profile/update', {
                method: 'POST',
                body: formData
            })
                .then(response => {
                    if (response.ok) {
                        // ƒê√≥ng modal hi·ªán t·∫°i (modal ch·ªânh s·ª≠a th√¥ng tin)
                        profileModal.hide();

                        // M·ªü l·∫°i modal (n·∫øu c·∫ßn thi·∫øt)
                        // Gi·∫£ s·ª≠ b·∫°n c√≥ m·ªôt modal kh√°c ƒë·ªÉ hi·ªÉn th·ªã k·∫øt qu·∫£ th√†nh c√¥ng
                        const successModal = new bootstrap.Modal(document.getElementById('successModal'), {
                            keyboard: false
                        });
                        successModal.show();
                    } else {
                        alert('ƒê√£ c√≥ l·ªói x·∫£y ra!');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }

    </script>
</body>
</html>